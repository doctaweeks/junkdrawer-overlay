From 61ea173eae22fd183cd6c4dc3c0c7f969673c1e9 Mon Sep 17 00:00:00 2001
From: "Daniel M. Weeks" <dan@danweeks.net>
Date: Mon, 21 Aug 2017 21:13:32 -0400
Subject: [PATCH] Fix SYSCONFDIR use

Signed-off-by: Daniel M. Weeks <dan@danweeks.net>
---
 CMakeLists.txt                      | 2 +-
 iwpmd/CMakeLists.txt                | 4 ++--
 kernel-boot/CMakeLists.txt          | 2 +-
 providers/ipathverbs/CMakeLists.txt | 2 +-
 providers/mlx4/CMakeLists.txt       | 2 +-
 srp_daemon/CMakeLists.txt           | 4 ++--
 6 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 2324cf49..54ff7b80 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -70,7 +70,7 @@ set(BUILD_LIB ${CMAKE_BINARY_DIR}/lib)
 # Used for IN_PLACE configuration
 set(BUILD_ETC ${CMAKE_BINARY_DIR}/etc)
 
-set(CMAKE_INSTALL_INITDDIR "${CMAKE_INSTALL_SYSCONFDIR}/init.d"
+set(CMAKE_INSTALL_INITDDIR "${CMAKE_INSTALL_FULL_SYSCONFDIR}/init.d"
   CACHE PATH "Location for init.d files")
 set(CMAKE_INSTALL_SYSTEMD_SERVICEDIR "${CMAKE_INSTALL_PREFIX}/lib/systemd/system"
   CACHE PATH "Location for systemd service files")
diff --git a/iwpmd/CMakeLists.txt b/iwpmd/CMakeLists.txt
index bf538034..97a7771c 100644
--- a/iwpmd/CMakeLists.txt
+++ b/iwpmd/CMakeLists.txt
@@ -21,7 +21,7 @@ rdma_subst_install(FILES "iwpmd_init.in"
   DESTINATION "${CMAKE_INSTALL_INITDDIR}"
   RENAME "iwpmd"
   PERMISSIONS OWNER_WRITE OWNER_READ GROUP_READ WORLD_READ OWNER_EXECUTE GROUP_EXECUTE WORLD_EXECUTE)
-install(FILES "iwpmd.conf" DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}")
+install(FILES "iwpmd.conf" DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}")
 
 install(FILES "iwpmd.rules"
   RENAME "90-iwpmd.rules"
@@ -29,4 +29,4 @@ install(FILES "iwpmd.rules"
 
 install(FILES modules-iwpmd.conf
   RENAME "iwpmd.conf"
-  DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}/rdma/modules")
+  DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}/rdma/modules")
diff --git a/kernel-boot/CMakeLists.txt b/kernel-boot/CMakeLists.txt
index 299a8f3f..b99f9165 100644
--- a/kernel-boot/CMakeLists.txt
+++ b/kernel-boot/CMakeLists.txt
@@ -14,7 +14,7 @@ install(FILES
   modules/opa.conf
   modules/rdma.conf
   modules/roce.conf
-  DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}/rdma/modules")
+  DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}/rdma/modules")
 
 install(FILES "rdma-description.rules"
   RENAME "75-rdma-description.rules"
diff --git a/providers/ipathverbs/CMakeLists.txt b/providers/ipathverbs/CMakeLists.txt
index 9031b86d..060037e8 100644
--- a/providers/ipathverbs/CMakeLists.txt
+++ b/providers/ipathverbs/CMakeLists.txt
@@ -4,7 +4,7 @@ rdma_provider(ipathverbs
   )
 
 rdma_subst_install(FILES "truescale.conf.in"
-  DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}/modprobe.d/"
+  DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}/modprobe.d/"
   RENAME "truescale.conf")
 install(FILES truescale-serdes.cmds
   DESTINATION "${CMAKE_INSTALL_LIBEXECDIR}"
diff --git a/providers/mlx4/CMakeLists.txt b/providers/mlx4/CMakeLists.txt
index 2cd668cb..958aef91 100644
--- a/providers/mlx4/CMakeLists.txt
+++ b/providers/mlx4/CMakeLists.txt
@@ -13,4 +13,4 @@ publish_headers(infiniband
   mlx4dv.h
 )
 
-install(FILES "mlx4.conf" DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}/modprobe.d/")
+install(FILES "mlx4.conf" DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}/modprobe.d/")
diff --git a/srp_daemon/CMakeLists.txt b/srp_daemon/CMakeLists.txt
index 0e7de959..3f064ef3 100644
--- a/srp_daemon/CMakeLists.txt
+++ b/srp_daemon/CMakeLists.txt
@@ -41,7 +41,7 @@ rdma_subst_install(FILES srp_daemon_port@.service.in
   RENAME srp_daemon_port@.service
   PERMISSIONS OWNER_WRITE OWNER_READ GROUP_READ WORLD_READ)
 
-install(FILES srp_daemon.conf DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}")
+install(FILES srp_daemon.conf DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}")
 
 install(FILES "srp_daemon.rules"
   RENAME "60-srp_daemon.rules"
@@ -49,7 +49,7 @@ install(FILES "srp_daemon.rules"
 
 install(FILES modules-srp_daemon.conf
   RENAME "srp_daemon.conf"
-  DESTINATION "${CMAKE_INSTALL_SYSCONFDIR}/rdma/modules")
+  DESTINATION "${CMAKE_INSTALL_FULL_SYSCONFDIR}/rdma/modules")
 
 # FIXME: The ib init.d file should really be included in rdma-core as well.
 set(RDMA_SERVICE "openibd" CACHE STRING "init.d file service name to order srpd after")
